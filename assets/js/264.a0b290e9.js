(window.webpackJsonp=window.webpackJsonp||[]).push([[264],{584:function(s,a,t){"use strict";t.r(a);var e=t(3),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"安装docker-desktop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装docker-desktop"}},[s._v("#")]),s._v(" 安装docker desktop")]),s._v(" "),a("ol",[a("li",[s._v("下载docker desktop https://www.docker.com/get-started/")]),s._v(" "),a("li",[s._v("点点点 安装完成")])]),s._v(" "),a("h2",{attrs:{id:"配置国内镜像地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置国内镜像地址"}},[s._v("#")]),s._v(" 配置国内镜像地址")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("启动 docker desktop")])]),s._v(" "),a("li",[a("p",[s._v("配置国内镜像地址")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("点击docker desktop右上角设置")])]),s._v(" "),a("li",[a("p",[s._v("配置源")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/hellolib/pictures/main/Typora/pic-00-gitee/20220721223535.png",alt:"image-20220721223535649"}})])])])])]),s._v(" "),a("h2",{attrs:{id:"启动k8s"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动k8s"}},[s._v("#")]),s._v(" 启动k8s")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/hellolib/pictures/main/Typora/pic-00-gitee/20220721223741.png",alt:"image-20220721223741796"}})]),s._v(" "),a("h2",{attrs:{id:"安装dashboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装dashboard"}},[s._v("#")]),s._v(" 安装Dashboard")]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("创建 Dashboard  pod")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("查看 Dashboard  pod 健康状态")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("kubectl get pods -n kube-system\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/hellolib/pictures/main/Typora/pic-00-gitee/20220721224109.png",alt:"image-20220721224109349"}})]),s._v(" "),a("ul",[a("li",[a("p",[s._v("如果处于"),a("code",[s._v("ImagePullBackOff")]),s._v("状态，镜像拉取失败， 使用命令  "),a("code",[s._v("kubectl describe pods kubernetes-dashboard-cd4778d69-7stbb -n kube-system")]),s._v(" 查看pod日志")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Events:\n  Type     Reason     Age                    From                Message\n  ----     ------     ----                   ----                -------\n  Normal   Scheduled  4m38s                  default-scheduler   Successfully assigned kube-system/kubernetes-dashboard-975499656-krwl7 to k8s-node2\n  Normal   Pulling    2m32s "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x4 over 4m38s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  kubelet, k8s-node2  Pulling image "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"k8s.gcr.io/kubernetes-dashboard-amd64:v1.10.1"')]),s._v("\n  Warning  Failed     2m16s "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x4 over 4m22s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  kubelet, k8s-node2  Failed to pull image "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"k8s.gcr.io/kubernetes-dashboard-amd64:v1.10.1"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" rpc error: code "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Unknown desc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Error response from daemon: Get https://k8s.gcr.io/v2/: net/http: request canceled "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" connection "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Client.Timeout exceeded "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" awaiting headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Warning  Failed     2m16s "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x4 over 4m22s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  kubelet, k8s-node2  Error: ErrImagePull\n  Normal   BackOff    112s "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x6 over 4m22s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   kubelet, k8s-node2  Back-off pulling image "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"k8s.gcr.io/kubernetes-dashboard-amd64:v1.10.1"')]),s._v("\n  Warning  Failed     99s "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x7 over 4m22s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    kubelet, k8s-node2  Error: ImagePullBackOff\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[a("code",[s._v("ImagePullBackOff")]),s._v("解决办法")]),s._v("： 手动拉取镜像， 并修改标签")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 手动拉取镜像：注意版本号")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull loveone/kubernetes-dashboard-amd64:v1.10.1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改标签：注意版本号，修改自己报错日志的版本号")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag loveone/kubernetes-dashboard-amd64:v1.10.1 k8s.gcr.io/kubernetes-dashboard-amd64:v1.10.1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新创建Dashboard pod")]),s._v("\nkubectl delete -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml\n\nkubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("启动 kubectl proxy")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v(" kubectl proxy -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认端口号 80001 ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("页面访问")]),s._v(" "),a("code",[s._v("http://localhost:8000/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/login")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/hellolib/pictures/main/Typora/pic-00-gitee/20220721225106.png",alt:"image-20220721225106069"}})])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("创建 ServiceAccount")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("本地创建"),a("code",[s._v("k8s-admin.yaml")])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ServiceAccount\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("user\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dashboard\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" rbac.authorization.k8s.io/v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ClusterRoleBinding\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("user\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("roleRef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiGroup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" rbac.authorization.k8s.io\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ClusterRole\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("admin\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("subjects")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ServiceAccount\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("user\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dashboard\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("创建service account")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("kubectl apply -f k8s-admin.yaml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("获取token")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("kubectl -n kubernetes-dashboard create token admin-user\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])])]),s._v(" "),a("li",[a("p",[s._v("在页面输入token，登陆即可")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);