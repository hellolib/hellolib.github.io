(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{459:function(s,t,n){"use strict";n.r(t);var a=n(3),e=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("ul",[t("li",[t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("协程和线程\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#共同点:")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("线程和协程的创建"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("切换销毁都需要时间开销"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("在cpython中线程和协程都不能利用多个cpu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("只能并发"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不同点:")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("多线程线程的切换是由操作系统完成"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("而协程的切换是通过代码实现"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("操作系统不可见\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("多线程创建"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("切换销毁时间开销较大"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("协程的时间开销很小"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("携程切换用户可操作性"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("不会增加操作系统压力\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])])]),s._v(" "),t("li",[t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进程:")]),s._v("\n开销大"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("数据隔离"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("是cpu最小的资源分配单位"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("至少有一个线程"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("cpython可以并行\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#线程:")]),s._v("\n开销小"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("数据共享"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("是cpu最小的调度单位"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("是进程的一部分"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("cpython下只可以并发\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("互斥锁和递归锁\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#相同点:")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("都是一种锁\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v("都是为了解决数据安全隐患\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不同点:")]),s._v("\nLock"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("互斥锁  不能在一个线程中连续acquire，效率相对高\nRlock"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("递归锁  可以在一个线程中连续acquire，效率相对低\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#简述 进程、线程、协程的区别 以及应用场景？")]),s._v("\n进程"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("开销大"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("数据隔离"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("是cpu最小的资源分配单位"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("至少有一个线程"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("cpython可以并行"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("程序开启时就开启了一个进程\n线程"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("开销小"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("数据共享"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("是cpu最小的调度单位"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("是进程的一部分"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("cpython下只可以并发\n协程"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("开销小"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("不能并行"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("只能并发"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("可以使一个线程下的多个任务再碰见IO操作时"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("交替执行"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("提高效率\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#应用场景:")]),s._v("\n程序的开启就开启了进程"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n一个单独的子线程去做一件事"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("分析网页"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("没有什么io操作就可以单独开线程\n大量任务等待去做要求一定的并发"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("而且有很多的IO操作就要尽可能使用协程\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 操作系统")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.计算机中所有的资源都是由操作系统分配的")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.操作系统调度任务：时间分片、多道机制")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.CPU的利用率是我们努力的指标")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 并发")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进程 开销大 数据隔离 资源分配单位 cpython下可以利用多核")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进程的三状态：就绪 运行 阻塞")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# multiprocessing模块")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Process-开启进程")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Lock - 互斥锁")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为什么要在进程中加锁")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 因为进程操作文件也会发生数据不安全")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Queue -队列 IPC机制（Pipe,redis,memcache,rabbitmq,kafka）")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生产者消费者模型")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Manager - 提供数据共享机制")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 线程 开销小 数据共享 cpu调度单位  cpython下不能利用多核")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# GIL锁")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全局解释器锁")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Cpython解释器提供的")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导致了一个进程中多个线程同一时刻只有一个线程能当问CPU -- 多线程不能利用多核")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# threading")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Thread类 - 能开启线程start，等待线程结束join")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Lock-互斥锁  不能在一个线程中连续acquire，效率相对高")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Rlock-递归锁  可以在一个线程中连续acquire，效率相对低")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 死锁现象如何发生?如何避免？")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 线程队列 queue模块")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Queue")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LifoQueue")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# PriorityQueue")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 池")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# concurrent.futrues.ThreadPoolExecutor,ProcessPoolExecutor")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 实例化一个池 tp = ThreadPoolExecutor(num),pp = ProcessPoolExecutor(num)")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交任务到池中，返回一个对象 obj = tp.submit(func,arg1,arg2...)")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用这个对象获取返回值 obj.result()")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 回调函数 obj.add_done_callback(函调函数)")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 阻塞等待池中的任务都结束 tp.shutdown()")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#协程全部!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 概念")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# IO操作")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同步异步")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 阻塞非阻塞")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.所有讲过的概念都记住")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.数据安全问题")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.数据隔离和通信")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.会用基本的进程 线程 池")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br")])])])]),s._v(" "),t("h2",{attrs:{id:"_1-协程的概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-协程的概念"}},[s._v("#")]),s._v(" 1.协程的概念")]),s._v(" "),t("ul",[t("li",[s._v("能够在一个线程下的多个任务之间来回切换,那么每一个任务就是协程")])]),s._v(" "),t("p",[s._v("![1558063115300](C:\\Users\\big cattle\\AppData\\Roaming\\Typora\\typora-user-images\\1558063115300.png)")]),s._v(" "),t("p",[t("code",[s._v("进程和线程的切换是由操作系统控制切换")])]),s._v(" "),t("ul",[t("li",[t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("协程和线程\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#共同点:")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("线程和协程的创建"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("切换销毁都需要时间开销"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("在cpython中线程和协程都不能利用多个cpu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("只能并发"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不同点:")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("多线程线程的切换是由操作系统完成"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("而协程的切换是通过代码实现"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("操作系统不可见\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("多线程创建"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("切换销毁时间开销较大"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("协程的时间开销很小"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("携程切换用户可操作性"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("不会增加操作系统压力\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])])])]),s._v(" "),t("h2",{attrs:{id:"_2-协程操作-模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-协程操作-模块"}},[s._v("#")]),s._v(" 2.协程操作(模块)")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("线程切换")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("两种切换方式")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("两种切换方式\n    # 原生python完成   yield  asyncio\n    # C语言完成的python模块  greenlet  gevent\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("原生python代码实现     (asyncos 模块)- asyncos利用yield记录线程代码执行状态和位置,但是yield不能规避io操作")])]),s._v(" "),t("li",[t("p",[s._v("C语言完成的PYthon模块(#greenlet模块)")])])])])])]),s._v(" "),t("li",[t("p",[s._v("规避IO操作,切换原理(了解)")]),s._v(" "),t("p",[s._v("![1558067064860](C:\\Users\\big cattle\\AppData\\Roaming\\Typora\\typora-user-images\\1558067064860.png)")])])]),s._v(" "),t("h3",{attrs:{id:"_2-1-gevent-第三方模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-gevent-第三方模块"}},[s._v("#")]),s._v(" 2.1 gevent 第三方模块")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("基本格式")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" time\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" gevent\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" gevent "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" monkey\t\t\t\nmonkey"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("patch_all"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#用mokey模块使协程识别多次使用的外部方法,比如time.time()")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("eat")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wusir is eating'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sleep"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wusir finished eat'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'小马哥 is sleeping'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sleep"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'小马哥 finished sleep'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# g1 = gevent.spawn(eat)   # 创造一个协程任务")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# g2 = gevent.spawn(sleep)   # 创造一个协程任务")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print(g1.value)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print(g2.value)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # g1.join()   # 阻塞 直到g1任务完成为止")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # g2.join()   # 阻塞 直到g1任务完成为止")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gevent.joinall([g1,g2,g3])\t\t#知道列表内的协程任务全部终止为止")]),s._v("\ng_l "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    g "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" gevent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("spawn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("eat"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    g_l"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("g"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ngevent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("joinall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("g_l"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("接收返回值")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("value")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# g1 = gevent.spawn(eat)  # 创造一个协程任务")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# g2 = gevent.spawn(sleep)  # 创造一个协程任务 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print(g2.value)")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])])])])]),s._v(" "),t("h3",{attrs:{id:"_2-2-asyncio-内置模块-记住启动一个-多个线程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-asyncio-内置模块-记住启动一个-多个线程"}},[s._v("#")]),s._v(" 2.2 asyncio 内置模块(记住启动一个/多个线程)")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("async-异步  sync-同步")])]),s._v(" "),t("li",[t("p",[s._v("asyncio 协程基本格式")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#起一个任务")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" asyncio\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#插入asyncio模块")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("demo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建async函数")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'start'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" asyncio"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sleep"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#阻塞,阻塞必须写入await之后\t且使用asyncio模块自己的方法")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'end'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  loop "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" asyncio"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_event_loop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建一个第三方事件循环,监测是否IO")]),s._v("\n  loop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("run_until_complete"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("demo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#吧demo任务丢到事件循环中去执行")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code")]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"})])])]),s._v(" "),t("p",[s._v("#起多个任务,且没有返回值")]),s._v(" "),t("p",[s._v("import asyncio")]),s._v(" "),t("p",[s._v("async def demo():\nprint('start')\nawait asyncio.sleep(1)\t#阻塞,阻塞必须写入await之后\t且使用asyncio模块自己的方法\nprint('end')")]),s._v(" "),t("p",[s._v("loop = asyncio.get_event_loop()\nwait_obj=asyncio.wait([demo(),demo(),demo()])\nloop.run_until_complete(wait_obj)")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("\n\n\n```python\n#起多个任务,有返回值(了解)\n\nimport asyncio \nasrnc def demo():\n\tprint('start')\n    await asyncio.sleep(1)\t#阻塞,阻塞必须写入await之后\t且使用asyncio模块自己的方法\n    print('end')\n    retunrn 123\n\nloop = asyncio.get-event_loop()\nt1 = loop.create_task(demo())\nt2 = loop.create_task(demo())\ntasks=[t1,t2]\nwait_obj=asyncio.wait([t1,t2])\nloop.run_until_complete(wait_obj)\nfor i in easks:\nprint(tasks.result())\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("ul",[t("li",[t("p",[t("strong",[s._v("asyncos是python原生的底层的协程模块")])]),s._v(" "),t("ul",[t("li",[s._v("爬虫,webserver框架")]),s._v(" "),t("li",[s._v("爬虫网络编程的效率和并发效果")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("await 阻塞必须写在await之后,告诉协程函数这里要切换出去,还能保证一会再切回来")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("await 必须写在async函数里,async是协程函数")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("loop 时间循环")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("所有的协程的执行,调度都离不开这个loop")])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);